# This file is auto-generated.
# Do not modify directly.
# ---
networks:
  localdockerstacknetwork:
    driver: bridge
services:
  queueservice:
    image: vsouza/sqs-local:latest
    privileged: false
    deploy:
      mode: replicated
      replicas: 1
    ports:
      - 9324:9324
    networks:
      localdockerstacknetwork:
        aliases:
          - sqs.local
  storageservice:
    image: minio/minio:latest
    command: server /data
    privileged: false
    deploy:
      mode: replicated
      replicas: 1
    ports:
      - 9000:9000
    volumes:
      - type: bind
        source: ../.s3
        target: /data
    networks:
      localdockerstacknetwork:
        aliases:
          - s3.local
  postgreslocal:
    image: postgres:latest
    command: postgres
    privileged: false
    deploy:
      mode: replicated
      replicas: 1
    environment:
      POSTGRES_DB: wavekb-local
      POSTGRES_USER: wavekb
      POSTGRES_PASSWORD: local
      POSTGRES_HOST_AUTH_METHOD: trust
    ports:
      - 5432:5432
    volumes:
      - type: bind
        source: ../.postgres
        target: /var/lib/postgresql/data
    networks:
      localdockerstacknetwork:
        aliases:
          - postgres.local
  nextjslocal:
    image: node:alpine
    user: "1000"
    command: sh -c 'cd /app && npm run dev'
    privileged: false
    deploy:
      mode: replicated
      replicas: 1
    environment:
      PORT: "4000"
      QUEUE_URL: http://sqs.local:9324
      STORAGE_URL: http://s3.local:9000
      POSTGRES_URL: postgres://wavekb:local@postgres.local/wavekb-local
    ports:
      - 4000:4000
    volumes:
      - type: bind
        source: ../app
        target: /app
    networks:
      localdockerstacknetwork:
        aliases:
          - nextjs.local
name: localdockerstackproject
